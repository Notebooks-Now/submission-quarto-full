<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
  <front>
    <journal-meta>
      <journal-id/>
      <journal-title-group>
        <journal-title>Notebooks Now!</journal-title>
      </journal-title-group>
      <issn/>
      <publisher>
        <publisher-name/>
      </publisher>
    </journal-meta>
    <article-meta>
      <title-group>
        <article-title>La Palma Earthquakes</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" corresp="yes">
          <contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
          <name>
            <surname>Purves</surname>
            <given-names>Steve</given-names>
          </name>
          <string-name>Steve Purves</string-name>
          <email>steve@curvenote.com</email>
          <xref ref-type="aff" rid="aff-1">a</xref>
          <xref ref-type="corresp" rid="cor-1">*</xref>
        </contrib>
        <contrib contrib-type="author">
          <contrib-id contrib-id-type="orcid">0000-0002-7859-8394</contrib-id>
          <name>
            <surname>Cockett</surname>
            <given-names>Rowan</given-names>
          </name>
          <string-name>Rowan Cockett</string-name>
          <xref ref-type="aff" rid="aff-1">a</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1">
        <institution-wrap>
          <institution>Curvenote</institution>
        </institution-wrap>
      </aff>
      <author-notes>
        <corresp id="cor-1">steve@curvenote.com</corresp>
      </author-notes>
      <pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-05-11">
        <year>2022</year>
        <month>5</month>
        <day>11</day>
      </pub-date>
      <history/>
      <abstract>
        <disp-quote>
          <p>The notebook should include an abstract cell at the beginning. If
  you inspect the metadata for this cell, you will find
  <monospace>"part": "abstract"</monospace>. This
  metadata is required for recognizing the content of this cell as the
  abstract.</p>
          <p>The abstract should begin with a short description of the problem
  addressed, briefly describe the new data or analyses, then briefly
  state the main conclusion(s) and how they are supported, and address
  any uncertainty.</p>
        </disp-quote>
        <p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). We have created an accessible dataset from this and
completed preliminary data analysis which shows seismicity originating
at two distinct depths, consistent with the model of a two reservoir
system feeding the currently very active volcano.</p>
      </abstract>
      <kwd-group kwd-group-type="author">
        <kwd>La Palma</kwd>
        <kwd>Earthquakes</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="introduction">
      <title>Introduction</title>
      <disp-quote>
        <p>The content of your notebook may be broken into any number of
    markdown or code cells. Markdown cells use MyST markdown and support
    <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/typography">standard
    markdown typography</ext-link> and many
    <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/syntax-overview">directives
    and roles</ext-link> for figures, tables, equations, etc.</p>
      </disp-quote>
      <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands, a Spanish territory situated is the
  Atlantic Ocean where at their closest point are 100km from the African
  coast <xref alt="Figure 1" rid="fig-map">Figure 1</xref>. The island
  is one of the youngest, remains active and is still in the island
  forming stage.</p>
      <disp-quote>
        <p>Figures may be added to your notebook using the
    <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/figures">figure
    directive</ext-link>. They may refer to images saved in your
    <monospace>images/</monospace> folder, images from the web, or
    notebook cell outputs
    <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/cross-references#targeting-cells">referenced
    by label</ext-link>. The <monospace>:name:</monospace> is used to
    reference the figure in your text; a reference to the following
    figure is found in the paragraph above. The figure caption is given
    as the body of this directive.</p>
      </disp-quote>
      <fig id="fig-map">
        <caption>
          <p>Figure 1: Map of La Palma in the Canary Islands. Image
    credit
    <ext-link ext-link-type="uri" xlink:href="https://commons.wikimedia.org/w/index.php?curid=76638603">NordNordWest</ext-link></p>
        </caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png"/>
      </fig>
      <p>La Palma has been constructed by various phases of volcanism, the
  most recent and currently active being the <italic>Cumbre
  Vieja</italic> volcano, a north-south volcanic ridge that constitutes
  the southern half of the island.</p>
      <sec id="eruption-history">
        <title>Eruption History</title>
        <p>A number of eruptions were recorded since the colonization of the
    islands by Europeans in the late 1400s, these are summarised in
    <xref alt="Table 1" rid="tbl-history">Table 1</xref>.</p>
        <disp-quote>
          <p>Simple tables may be created using the
      <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/tables">list-table
      directive</ext-link>. Similar to figures, tables may be referenced
      in the text by their <monospace>name</monospace>. The caption for
      this table is the first line of the directive.</p>
        </disp-quote>
        <table-wrap>
          <caption>
            <p>Table 1: Recent historic eruptions on La Palma</p>
          </caption>
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Year</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Current</td>
                <td>2021</td>
              </tr>
              <tr>
                <td>Teneguía</td>
                <td>1971</td>
              </tr>
              <tr>
                <td>Nambroque</td>
                <td>1949</td>
              </tr>
              <tr>
                <td>El Charco</td>
                <td>1712</td>
              </tr>
              <tr>
                <td>Volcán San Antonio</td>
                <td>1677</td>
              </tr>
              <tr>
                <td>Volcán San Martin</td>
                <td>1646</td>
              </tr>
              <tr>
                <td>Tajuya near El Paso</td>
                <td>1585</td>
              </tr>
              <tr>
                <td>Montaña Quemada</td>
                <td>1492</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>This equates to an eruption on average every 79 years up until
    the 1971 event. The probability of a future eruption can be modeled
    by a Poisson distribution
    <xref alt="Equation 1" rid="eq-poisson">Equation 1</xref>.</p>
        <disp-quote>
          <p>Numbered equations may be defined using the
      <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/math">math
      directive or in line</ext-link>. Equations defined with the math
      directive may be reference in the text by label.</p>
        </disp-quote>
        <p>
          <styled-content id="eq-poisson">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    p(x)=\frac{e^{-\lambda} \lambda^{x}}{x !}
     \qquad(1)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mi>λ</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mi>λ</mml:mi>
                          <mml:mi>x</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mi>!</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>Where <inline-formula><alternatives><tex-math><![CDATA[\lambda]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
    is the number of eruptions per year, <inline-formula><alternatives><tex-math><![CDATA[\lambda=\frac{1}{79}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>79</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>
    in this case. The probability of a future eruption in the next
    <inline-formula><alternatives><tex-math><![CDATA[t]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
    years can be calculated by:</p>
        <p>
          <styled-content id="eq-probability">
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    p_e = 1-\mathrm{e}^{-t \lambda}
     \qquad(2)]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>p</mml:mi>
                      <mml:mi>e</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi mathvariant="normal">e</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mi>λ</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2.0em"/>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </styled-content>
        </p>
        <p>So following the 1971 eruption the probability of an eruption in
    the following 50 years — the period ending this year — was 0.469.
    After the event, the number of eruptions per year moves to
    <inline-formula><alternatives><tex-math><![CDATA[\lambda=\frac{1}{75}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>75</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>
    and the probability of a further eruption within the next 50 years
    (2022-2071) rises to 0.487 and in the next 100 years, this rises
    again to 0.736.</p>
      </sec>
      <sec id="magma-reservoirs">
        <title>Magma Reservoirs</title>
        <disp-quote>
          <p>You may
      <ext-link ext-link-type="uri" xlink:href="https://myst-tools.org/docs/mystjs/citations">add
      citations two ways</ext-link>. First, you may simply insert a
      markdown link link to a DOI like so:
      <ext-link ext-link-type="uri" xlink:href="10.1093/nar/22.22.4673"/>.
      No additional bibliographic information is required for this
      approach; the reference will be looked up by DOI and added
      implicitly to the references. Alternatively, you may provide the
      bibliography directly as <monospace>references.bib</monospace>
      bibtex file, then embed the citation by bibtex key in your text
      using the <monospace>cite:p</monospace> or
      <monospace>cite:t</monospace> for parenthetical or textual
      citations, respectively. The following paragraph provides an
      example of this. A single paper may combine both DOI and bibtex
      citations.</p>
        </disp-quote>
        <p>Studies of the magma systems feeding the volcano, such as Marrero
    et al.
    (<xref alt="2019" rid="ref-marrero2019" ref-type="bibr">2019</xref>)
    has proposed that there are two main magma reservoirs feeding the
    Cumbre Vieja volcano; one in the mantle (30-40km depth) which
    charges and in turn feeds a shallower crustal reservoir (10-20km
    depth).</p>
        <fig id="fig-reservoirs">
          <caption>
            <p>Figure 2: Proposed model from Marrero et
      al</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="images/reservoirs.png"/>
        </fig>
        <p>In this paper, we look at recent seismicity data to see if we can
    see evidence of such a system action, see
    <xref alt="Figure 2" rid="fig-reservoirs">Figure 2</xref>.</p>
      </sec>
    </sec>
    <sec id="dataset">
      <title>Dataset</title>
      <disp-quote>
        <p>All data used in the notebook should be present in the
    <monospace>data/</monospace> folder so notebooks may be executed in
    place with no additional input.</p>
      </disp-quote>
      <p>The earthquake dataset used in our analysis was generated from the
  <ext-link ext-link-type="uri" xlink:href="https://www.ign.es/web/resources/volcanologia/tproximos/canarias.html">IGN
  web portal</ext-link> this is public data released under a permissive
  license. Data recorded using the network of
  <xref alt="Seismic Monitoring Stations" rid="stations">Seismic
  Monitoring Stations</xref> on the island. A web scraping script was
  developed to pull data into a machine-readable form for analysis. That
  code tool
  <ext-link ext-link-type="uri" xlink:href="https://github.com/stevejpurves/ign-earthquake-data">is
  available on GitHub</ext-link> along with a copy of recently updated
  data.</p>
    </sec>
    <sec id="results">
      <title>Results</title>
      <p>The dataset was loaded into a Jupyter notebook
  <ext-link ext-link-type="uri" xlink:href="./notebooks/visualization-figure-creation-seaborn.ipynb">visualization</ext-link>
  and filtered down to La Palma events only. This results in 5465 data
  points which we then visualized to understand their distributions
  spatially, by depth, by magnitude and in time.</p>
      <fig id="fig-timeline">
        <caption>
          <p>Figure 3: Earthquake data over time (n=5465) to
    understand their distributions spatially, by depth, by magnitude and
    in time.</p>
        </caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/fig-timeline-output-1.png"/>
      </fig>
      <disp-quote>
        <p>This figure uses cell output from the
    <ext-link ext-link-type="uri" xlink:href="./notebooks/visualization-figure-creation-seaborn.ipynb">visualization
    notebook</ext-link>. The first line of the
    <ext-link ext-link-type="uri" xlink:href="fig-timeline">cell</ext-link>
    is <monospace>#| label: fig-timeline</monospace>. Referencing that
    label pulls in the output of the cell as a figure. ```</p>
      </disp-quote>
      <p>From our analysis in
  <xref alt="Figure 3" rid="fig-timeline">Figure 3</xref>, we can see 3
  different systems in play.</p>
      <p>Firstly, the shallow earthquake swarm leading up to the eruption on
  19th September, related to significant surface deformation and shallow
  magma intrusion.</p>
      <p>After the eruption, continuous shallow seismicity started at
  10-15km corresponding to magma movement in the crustal reservoir.</p>
      <p>Subsequently, high magnitude events begin occurring at 30-40km
  depths corresponding to changes in the mantle reservoir. These are
  also continuous but occur with a lower frequency than in the crustal
  reservoir.</p>
    </sec>
    <sec id="conclusions">
      <title>Conclusions</title>
      <p>From the analysis of the earthquake data collected and published by
  IGN for the period of 11 September through to 9 November 2021.
  Visualization of the earthquake events at different depths appears to
  confirm the presence of both mantle and crustal reservoirs as proposed
  by {cite:t}<monospace>marrero2019</monospace>.</p>
    </sec>
    <sec id="availability">
      <title>Availability</title>
      <disp-quote>
        <p>Data availability statement should be specified in a separate
    block with metadata
    <monospace>"part": "availability"</monospace>,
    similar to the abstract.</p>
        <p>AGU requires an Availability Statement for the underlying data
    needed to understand, evaluate, and build upon the reported research
    at the time of peer review and publication.</p>
      </disp-quote>
      <p>A web scraping script was developed to pull data into a
  machine-readable form for analysis. That code tool
  <ext-link ext-link-type="uri" xlink:href="https://github.com/stevejpurves/ign-earthquake-data">is
  available on GitHub</ext-link> along with a copy of recently updated
  data.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <ref id="ref-marrero2019">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name>
              <surname>Marrero</surname>
              <given-names>José</given-names>
            </name>
            <name>
              <surname>García</surname>
              <given-names>Alicia</given-names>
            </name>
            <name>
              <surname>Berrocoso</surname>
              <given-names>Manuel</given-names>
            </name>
            <name>
              <surname>Llinares</surname>
              <given-names>Ángeles</given-names>
            </name>
            <name>
              <surname>Rodríguez-Losada</surname>
              <given-names>Antonio</given-names>
            </name>
            <name>
              <surname>Ortiz</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
          <source>Journal of Applied Volcanology</source>
          <year iso-8601-date="2019-07">2019</year>
          <month>07</month>
          <volume>8</volume>
          <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
          <fpage/>
          <lpage/>
        </element-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article article-type="notebook">
    <front-stub>
      <title-group>
        <article-title>Visualization &amp; Figure Creation</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
          <name>
            <surname>Purves</surname>
            <given-names>Steve</given-names>
          </name>
          <string-name>Steve Purves</string-name>
        </contrib>
      </contrib-group>
    </front-stub>
    <body>
      <sec id="cell-8f3f2a59" sec-type="notebook-content">
        <sec id="main-timeline-figure">
          <title>Main Timeline Figure</title>
        </sec>
        <sec id="cell-12f72d64" sec-type="notebook-code">
          <code language="python">%matplotlib inline
import pandas as pd
import matplotlib
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
sns.set_theme(style="whitegrid")</code>
        </sec>
        <sec id="cell-291dc1cc" sec-type="notebook-code">
          <code language="python">def make_category_columns(df):
    df['Depth'] = 'Shallow (&lt;18km)'
    df.loc[(df['Depth(km)'] &gt;= 18) &amp; (df['Depth(km)'] &lt;= 28), 'Depth'] = 'Interchange (18km&gt;x&gt;28km)'
    df.loc[df['Depth(km)'] &gt;= 28, 'Depth'] = 'Deep (&gt;28km)'
    
    df['Mag'] = 0
    df.loc[(df['Magnitude'] &gt;= 1) &amp; (df['Magnitude'] &lt;= 2), 'Mag'] = 1
    df.loc[(df['Magnitude'] &gt;= 2) &amp; (df['Magnitude'] &lt;= 3), 'Mag'] = 2
    df.loc[(df['Magnitude'] &gt;= 3) &amp; (df['Magnitude'] &lt;= 4), 'Mag'] = 3
    df.loc[(df['Magnitude'] &gt;= 4) &amp; (df['Magnitude'] &lt;= 5), 'Mag'] = 4    
    
    return df</code>
        </sec>
        <sec id="cb96f187" sec-type="notebook-content">
</sec>
        <sec id="visualising-long-term-earthquake-data">
          <title>Visualising Long term earthquake data</title>
          <p>Data taken directly from the IGN Catalog and processed using the
  <ext-link ext-link-type="uri" xlink:href="data-screening.ipynb">data
  screening notebook</ext-link>.</p>
        </sec>
        <sec id="f48a68e0" sec-type="notebook-code">
          <code language="python">df_ign = pd.read_csv('../data/lapalma_ign.csv')
df_ign = make_category_columns(df_ign)
df_ign.head()</code>
          <sec id="f48a68e0-output-0" content-type="notebook-output">
            <table-wrap>
              <table border="1">
                <thead>
                  <tr style="text-align: right;">
                    <th/>
                    <th>Event</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Latitude</th>
                    <th>Longitude</th>
                    <th>Depth(km)</th>
                    <th>Intensity</th>
                    <th>Magnitude</th>
                    <th>Type Mag</th>
                    <th>Location</th>
                    <th>DateTime</th>
                    <th>Timestamp</th>
                    <th>Swarm</th>
                    <th>Phase</th>
                    <th>Depth</th>
                    <th>Mag</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>0</td>
                    <td>es2017eugju</td>
                    <td>2017-03-09</td>
                    <td>23:44:06</td>
                    <td>28.5346</td>
                    <td>-17.8349</td>
                    <td>26.0</td>
                    <td/>
                    <td>1.6</td>
                    <td>4</td>
                    <td>NE FUENCALIENTE DE LA PALMA.IL</td>
                    <td>2017-03-09 23:44:06</td>
                    <td>1489103046000000000</td>
                    <td>0.0</td>
                    <td>0</td>
                    <td>Interchange (18km&gt;x&gt;28km)</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>es2017euhlh</td>
                    <td>2017-03-10</td>
                    <td>00:16:10</td>
                    <td>28.5491</td>
                    <td>-17.8459</td>
                    <td>27.0</td>
                    <td/>
                    <td>2.0</td>
                    <td>4</td>
                    <td>N FUENCALIENTE DE LA PALMA.ILP</td>
                    <td>2017-03-10 00:16:10</td>
                    <td>1489104970000000000</td>
                    <td>0.0</td>
                    <td>0</td>
                    <td>Interchange (18km&gt;x&gt;28km)</td>
                    <td>2</td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>es2017cpaoh</td>
                    <td>2017-03-10</td>
                    <td>00:16:11</td>
                    <td>28.5008</td>
                    <td>-17.8863</td>
                    <td>20.0</td>
                    <td/>
                    <td>2.1</td>
                    <td>4</td>
                    <td>W LOS CANARIOS.ILP</td>
                    <td>2017-03-10 00:16:11</td>
                    <td>1489104971000000000</td>
                    <td>0.0</td>
                    <td>0</td>
                    <td>Interchange (18km&gt;x&gt;28km)</td>
                    <td>2</td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>es2017eunnk</td>
                    <td>2017-03-10</td>
                    <td>03:20:26</td>
                    <td>28.5204</td>
                    <td>-17.8657</td>
                    <td>30.0</td>
                    <td/>
                    <td>1.6</td>
                    <td>4</td>
                    <td>NW FUENCALIENTE DE LA PALMA.IL</td>
                    <td>2017-03-10 03:20:26</td>
                    <td>1489116026000000000</td>
                    <td>0.0</td>
                    <td>0</td>
                    <td>Deep (&gt;28km)</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>4</td>
                    <td>es2017kajei</td>
                    <td>2017-08-21</td>
                    <td>02:06:55</td>
                    <td>28.5985</td>
                    <td>-17.7156</td>
                    <td>0.0</td>
                    <td/>
                    <td>1.6</td>
                    <td>4</td>
                    <td>E EL PUEBLO.ILP</td>
                    <td>2017-08-21 02:06:55</td>
                    <td>1503281215000000000</td>
                    <td>0.0</td>
                    <td>0</td>
                    <td>Shallow (&lt;18km)</td>
                    <td>1</td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
          </sec>
        </sec>
        <sec id="cell-59c54f01" sec-type="notebook-code">
          <code language="python">df_ign['DateTime'] = pd.to_datetime(df_ign['Date'] + ' ' + df_ign['Time'])
df_ign['DateTime']</code>
          <sec id="59c54f01-output-0" content-type="notebook-output">
            <preformat>0       2017-03-09 23:44:06
1       2017-03-10 00:16:10
2       2017-03-10 00:16:11
3       2017-03-10 03:20:26
4       2017-08-21 02:06:55
                ...        
11342   2022-09-14 00:20:51
11343   2022-09-14 01:40:30
11344   2022-09-14 01:44:52
11345   2022-09-14 02:03:08
11346   2022-09-14 03:58:59
Name: DateTime, Length: 11347, dtype: datetime64[ns]</preformat>
          </sec>
        </sec>
        <sec id="f7731cea" sec-type="notebook-code">
          <code language="python">df_ign_early = df_ign[df_ign['DateTime'] &lt; '2021-09-11']
df_ign_pre = df_ign[(df_ign['DateTime'] &gt;= '2021-09-11')&amp;(df_ign['DateTime'] &lt; '2021-09-19 14:13:00')]
df_ign_phase1 = df_ign[(df_ign['DateTime'] &gt;= '2021-09-19 14:13:00')&amp;(df_ign['DateTime'] &lt; '2021-10-01')]
df_ign_phase2 = df_ign[(df_ign['DateTime'] &gt;= '2021-10-01')&amp;(df_ign['DateTime'] &lt; '2021-12-01')]
df_ign_phase3 = df_ign[(df_ign['DateTime'] &gt;= '2021-12-01')&amp;(df_ign['DateTime'] &lt;= '2021-12-31')]

df_erupt = df_ign[(df_ign['Date'] &lt; '2022-01-01') &amp; (df_ign['Date'] &gt; '2021-09-11')]

df_erupt_1 = df_erupt[df_erupt['Magnitude'] &lt; 1.0]
df_erupt_2 = df_erupt[(df_erupt['Magnitude'] &gt;= 1.0)&amp;(df_erupt['Magnitude'] &lt; 2.0)]
df_erupt_3 = df_erupt[(df_erupt['Magnitude'] &gt;= 2.0)&amp;(df_erupt['Magnitude'] &lt; 3.0)]
df_erupt_4 = df_erupt[(df_erupt['Magnitude'] &gt;= 3.0)&amp;(df_erupt['Magnitude'] &lt; 4.0)]
df_erupt_5 = df_erupt[df_erupt['Magnitude'] &gt; 4.0]</code>
        </sec>
        <sec id="cell-fig-timeline" sec-type="notebook-code">
          <code language="python">from matplotlib.patches import Rectangle

import datetime as dt
from matplotlib.dates import date2num, num2date

matplotlib.rcParams['font.sans-serif'] = "Helvetica"
matplotlib.rcParams['font.family'] = "sans-serif"
matplotlib.rcParams['xtick.labelsize'] = 14
matplotlib.rcParams['ytick.labelsize'] = 14
matplotlib.rcParams['ytick.labelleft'] = True
matplotlib.rcParams['ytick.labelright'] = True

fig = matplotlib.pyplot.figure(figsize=(24,12), dpi=300)
fig.tight_layout()
# Creating axis
# add_axes([xmin,ymin,dx,dy])
ax_min = fig.add_axes([0.01, 0.01, 0.01, 0.01])
ax_min.axis('off')
ax_max = fig.add_axes([0.99, 0.99, 0.01, 0.01])
ax_max.axis('off')

ax_timeline = fig.add_axes([0.04, 0.1, 0.92, 0.85])
ax_timeline.spines["top"].set_visible(False)
ax_timeline.spines["right"].set_visible(False)
ax_timeline.spines["left"].set_visible(False)
ax_timeline.grid(axis='x')


ax_timeline.axvline(x=dt.datetime(2021, 9, 19, 14, 13), ymin=0.075, ymax=0.98, color='r', linewidth=3)


def make_scatter(df, c, alpha=0.8):
    M = 3*np.exp2(1.3*df['Magnitude'])
    return ax_timeline.scatter(df['DateTime'], df['Depth(km)'], s=M, c=c, alpha=alpha, edgecolor='black', linewidth=0.5, zorder=2);

points_1 = make_scatter(df_erupt_1, c=[(0.890, 0.466, 0.760)], alpha=0.3)
points_2 = make_scatter(df_erupt_2, c=[(0.737, 0.741, 0.133)], alpha=0.4)
points_3 = make_scatter(df_erupt_3, c=[(0.172, 0.627, 0.172)], alpha=0.5)
points_4 = make_scatter(df_erupt_4, c=[(1.000, 0.498, 0.054)], alpha=0.6)
points_5 = make_scatter(df_erupt_5, c=[(0.839, 0.152, 0.156)], alpha=0.8)

ax_timeline.tick_params(axis='x', labelrotation=0, bottom=True)
ax_timeline.set_ylabel('')
ax_timeline.yaxis.set_ticks_position('both')
ax_timeline.yaxis.set_ticks_position('both')

xticks = ax_timeline.get_xticks()
new_xticks = [date2num(pd.to_datetime('2021-09-11')),
    date2num(pd.to_datetime('2021-09-19 14:13:00'))]
new_xticks = np.append(new_xticks, xticks[2:-1])
ax_timeline.set_xticks(new_xticks)

ax_timeline.invert_yaxis()
ax_timeline.spines['bottom'].set_position(('data', 45))
ax_timeline.margins(tight=True, x=0)
ax_timeline.legend(
    [points_1, points_2, points_3, points_4, points_5],
    ['0 &lt; M &lt;= 1','1 &lt; M &lt;= 2','2 &lt; M &lt;= 3','3 &lt; M &lt;= 4','M &gt; 4'],
    loc='lower left', bbox_to_anchor=(0.01, 0.1, 0.15, 0.1), fancybox=True,
    borderpad=1.0, labelspacing=1, mode="expand", title="Event Magnitude (M)",
    fontsize=14, title_fontsize=14, framealpha=1)

ax_timeline.set_ylim(ax_timeline.get_ylim()[0], -9)

plt.annotate('ERUPTION', (0.055, 0.42), rotation=90, xycoords='axes fraction', fontweight='bold', fontsize=20, color='r')
plt.annotate('Pre\nEruptive\nSwarm', (0.035, 0.88), rotation=0, xycoords='axes fraction', fontweight='bold', fontsize=20, color='b', horizontalalignment='center')
plt.annotate('Early Eruptive\nPhase', (0.12, 0.9), rotation=0, xycoords='axes fraction', fontweight='bold', fontsize=20, color='orange', horizontalalignment='center')
plt.annotate('Main Eruptive Phase\n(sustained gas and lava ejection)', (0.45, 0.9), rotation=0, xycoords='axes fraction', fontweight='bold', fontsize=20, color='green', horizontalalignment='center')
plt.annotate('Final Eruptive Phase\n(reducing gas and lava ejection)', (0.86, 0.9), rotation=0, xycoords='axes fraction', fontweight='bold', fontsize=20, color='r', horizontalalignment='center')

ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime('2021-09-11')), -8), date2num(pd.to_datetime('2021-09-19 14:13:00'))-date2num(pd.to_datetime('2021-09-11')), 53, color=(0.121, 0.466, 0.705), zorder=1, alpha=0.1))
ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime('2021-09-19 14:13:00')), -8), date2num(pd.to_datetime('2021-10-01'))-date2num(pd.to_datetime('2021-09-19 14:13:00')), 53, color=(1.000, 0.498, 0.055), zorder=1, alpha=0.1))
ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime('2021-10-01')), -8), date2num(pd.to_datetime('2021-12-01'))-date2num(pd.to_datetime('2021-10-01')), 53, color=(0.173, 0.627, 0.172), zorder=1, alpha=0.1))
ax_timeline.add_patch(Rectangle((date2num(pd.to_datetime('2021-12-01')), -8), date2num(pd.to_datetime('2021-12-31'))-date2num(pd.to_datetime('2021-12-01'))+1, 53, color=(0.839, 0.152, 0.156), zorder=1, alpha=0.1));

ax_timeline.set_title("Recorded seismicity during the La Palma eruption 11 September - 15 December 2021 (INVOLCAN Dataset)", dict(fontsize=24), pad=20)
ax_timeline.set_ylabel("Depth (km)", dict(fontsize=20), labelpad=20)
ax_timeline.set_xlabel("Eruption Timeline", dict(fontsize=20), labelpad=20);</code>
          <sec id="cell-fig-timeline-output-0" content-type="notebook-output">
            <fig id="fig-timeline-nb-0">
              <caption>
                <p>Figure 1: Earthquake data over time (n=5465) to
    understand their distributions spatially, by depth, by magnitude and
    in time.</p>
              </caption>
              <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/fig-timeline-output-1.png"/>
            </fig>
          </sec>
        </sec>
        <sec id="cell-63241424" sec-type="notebook-content">
</sec>
        <sec id="cumulative-distrubtion-plots">
          <title>Cumulative Distrubtion Plots</title>
        </sec>
        <sec id="abbf0d50" sec-type="notebook-code">
          <code language="python">def cumulative_events_mag_depth(df, hue='Depth', kind='scatter', ax=None, dpi=300, palette=None, kde=True):
    matplotlib.rcParams['ytick.labelright'] = False
    g = sns.jointplot(x="Magnitude", y="Depth(km)", data=df,
                      kind=kind, hue=hue, height=10, space=0.1, marginal_ticks=False, ratio=8, alpha=0.6,
                      hue_order=['Shallow (&lt;18km)', 'Interchange (18km&gt;x&gt;28km)', 'Deep (&gt;28km)'],
                      ax=ax, palette=palette, ylim=(-2,50), xlim=(0.3,5.6), edgecolor=".2", marginal_kws=dict(bins=20))
    if kde:
        g.plot_joint(sns.kdeplot, color="b", zorder=1, levels=15, ax=ax)
    g.fig.axes[0].invert_yaxis();
    g.fig.set_dpi(dpi)</code>
        </sec>
        <sec id="cell-9fc0146a" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign, hue=None)
plt.suptitle('Cumulative Events 01-01-2017 to 01-01-2022', y=1.01);</code>
          <sec id="9fc0146a-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-9-output-1.png"/>
          </sec>
        </sec>
        <sec id="b1fc42cc" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign_early, hue=None)
plt.suptitle(f'Events prior to 2021-09-11 ({len(df_ign_early.index)} events)', y=1.01);</code>
          <sec id="b1fc42cc-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-10-output-1.png"/>
          </sec>
        </sec>
        <sec id="cell-19e275d7" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign_pre, hue=None)
plt.suptitle(f"Events Immediately before Eruption 11-19 September 2021 ({len(df_ign_pre.index)} events)", y=1.01);</code>
          <sec id="19e275d7-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-11-output-1.png"/>
          </sec>
        </sec>
        <sec id="cell-4bcecbd4" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign_phase1, hue=None)
plt.suptitle(f"Events in Phase 1 of Eruption 2021-09-11 to 2021-09-30 ({len(df_ign_phase1.index)} events)", y=1.01);</code>
          <sec id="4bcecbd4-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-12-output-1.png"/>
          </sec>
        </sec>
        <sec id="cell-012f5878" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign_phase2, hue=None)
plt.suptitle(f"Events in Phase 2 of Eruption 2021-10-01 to 2021-11-31 ({len(df_ign_phase2.index)} events)", y=1.01);</code>
          <sec id="012f5878-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-13-output-1.png"/>
          </sec>
        </sec>
        <sec id="cell-32e0996c" sec-type="notebook-code">
          <code language="python">cumulative_events_mag_depth(df_ign_phase3, hue=None)
plt.suptitle(f"Events in Phase 3 of Eruption 2021-12-01 to 2021-12-31 ({len(df_ign_phase3.index)} events)", y=1.01);</code>
          <sec id="32e0996c-output-0" content-type="notebook-output">
            <graphic mimetype="image" mime-subtype="png" xlink:href="article_files/figure-jats/cell-14-output-1.png"/>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
</article>
